<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Friendly Rivalry - HYERI</title>
<link rel="icon" href="icon/icon.png" type="image/png" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600&display=swap" rel="stylesheet" />
<style>
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  body {
    background-color: #000;
    color: #fff;
    font-family: 'Cormorant Garamond', serif;
    font-weight: 300;
    line-height: 1.8;
    overflow-x: hidden;
  }
  header {
    background-color: rgba(0,0,0,0.95);
    color: #fff;
    padding: 1.5rem 0;
    position: fixed;
    top: 0; width: 100%;
    z-index: 100;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
  }
  .container {
    width: 90%;
    max-width: 1400px;
    margin: 0 auto;
  }
  .nav-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .logo {
    font-size: 2rem;
    font-weight: 300;
    letter-spacing: 8px;
    text-transform: uppercase;
    cursor: pointer;
    transition: letter-spacing 0.3s ease;
  }
  .logo:hover {
    letter-spacing: 12px;
  }
  .back-btn {
    color: #fff;
    text-decoration: none;
    font-weight: 300;
    font-size: 1.1rem;
    letter-spacing: 2px;
    transition: all 0.3s ease;
    border: 1px solid #fff;
    padding: 0.5rem 1.5rem;
  }
  .back-btn:hover {
    background-color: #fff;
    color: #000;
  }
  .work-section {
    padding: 10rem 0 5rem 0;
    min-height: 100vh;
  }
  .section-title {
    text-align: center;
    margin-bottom: 4rem;
  }
  .section-title h1 {
    font-size: 3.5rem;
    color: #fff;
    margin-bottom: 1.5rem;
    font-weight: 300;
    letter-spacing: 12px;
    text-transform: uppercase;
  }
  .section-title p {
    color: #ccc;
    font-size: 1.2rem;
    letter-spacing: 2px;
  }

  /* 五列瀑布流网格 */
.masonry-grid {
    column-count: 5;        /* 默认五列 */
    column-gap: 1.2rem;     /* 列间距 */
    width: 100%;
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
}

.masonry-item {
    display: inline-block;
    width: 100%;
    margin-bottom: 1.2rem;
    border-radius: 6px;
    overflow: hidden;
    cursor: pointer;
    /* 悬停样式 */
    transition: transform 0.3s ease;
    position: relative;
    transform-style: preserve-3d;
}

.masonry-item img {
    width: 100%;
    height: auto;
    display: block;
    filter: blur(20px);
    transition: filter 1.2s ease, transform 0.3s ease;
    will-change: filter;
    backface-visibility: hidden;
}

.masonry-item img.loaded {
    filter: blur(0);
}

.masonry-item:hover img {
    transform: scale(1.05);
    box-shadow: 0 10px 30px rgba(255,255,255,0.3);
}

/* 响应式，自适应列数 */
@media (max-width:1200px) {
    .masonry-grid { column-count: 4; }
}
@media (max-width:992px) {
    .masonry-grid { column-count: 3; }
}
@media (max-width:768px) {
    .masonry-grid { column-count: 2; padding: 0 10px; }
}
@media (max-width:480px) {
    .masonry-grid { column-count: 1; padding: 0 5px; }
}

.loading, .load-more {
    text-align: center;
    color: #ccc;
    font-size: 1.2rem;
    padding: 2rem 0;
    letter-spacing: 2px;
}
</style>
</head>
<body>
<header>
  <div class="container nav-container">
    <div class="logo" onclick="window.location.href='index.html'">HYERI</div>
    <a href="index.html" class="back-btn">Back</a>
  </div>
</header>

<section class="work-section">
  <div class="container">
    <div class="section-title">
      <h1>Friendly Rivalry</h1>
      <p>Behind the scenes and memorable moments</p>
    </div>

    <div class="loading" id="loading">Loading images...</div>
    <div class="masonry-grid" id="masonryGrid"></div>
    <div class="load-more" id="loadMore" style="display:none;">Scroll for more...</div>
  </div>
</section>

<script>
  const API_URL = 'https://api.hyeri.us.kg'; // 改成你的 Worker 地址
  const WORK_FOLDER = 'rivalry'; // R2文件夹名

  const BATCH_SIZE = 20;
  let allImages = [];
  let loadedCount = 0;

  const loading = document.getElementById('loading');
  const masonryGrid = document.getElementById('masonryGrid');
  const loadMore = document.getElementById('loadMore');

  // 监听滚动加载更多图片
  window.addEventListener('scroll', () => {
    if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 300) {
      loadMoreImages();
    }
  });

  // 加载下一批图片
  function loadMoreImages() {
    if (loadedCount >= allImages.length) {
      loadMore.textContent = 'No more images';
      return;
    }
    loadMore.style.display = 'block';

    const nextBatch = allImages.slice(loadedCount, loadedCount + BATCH_SIZE);
    nextBatch.forEach(url => {
      const div = document.createElement('div');
      div.className = 'masonry-item';
      const img = document.createElement('img');
      img.src = url;
      img.alt = '';
      // 图片渐变加载效果
      img.onload = () => {
        img.classList.add('loaded');
      };
      div.appendChild(img);
      masonryGrid.appendChild(div);
    });
    loadedCount += nextBatch.length;
  }

  // 初始化加载
  async function init() {
    try {
      const response = await fetch(API_URL);
      const data = await response.json();
      if (!data.success) {
        loading.textContent = 'Failed to load images from API.';
        return;
      }
      allImages = data.images.filter(url => url.includes(`/${WORK_FOLDER}/`));
      if (allImages.length === 0) {
        loading.textContent = 'No images found.';
        return;
      }
      loading.style.display = 'none';
      loadMoreImages();
    } catch (err) {
      loading.textContent = 'Loading error.';
      console.error(err);
    }
  }

  init();
</script>

</body>
</html>
